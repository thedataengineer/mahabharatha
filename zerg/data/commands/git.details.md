# ZERG Git (Details)

Detailed reference for all 11 git actions, their workflows, and advanced usage.

## Action: commit

Intelligent commit with auto-generated conventional commit messages.

### Modes

| Mode | Behavior |
|------|----------|
| (default) | Inline: stage -> analyze -> suggest message -> prompt -> commit |
| auto | Engine: stage all -> analyze diff -> generate message -> commit |
| confirm | Engine: analyze -> generate message -> wait for confirmation |
| suggest | Engine: analyze -> generate message -> print suggestion only |

### Conventional Commit Types

| Type | Triggers |
|------|----------|
| feat | add, implement, create, new, feature |
| fix | fix, bugfix, resolve, correct, patch |
| docs | doc, readme, comment, documentation |
| style | format, style, lint, whitespace, prettier |
| refactor | refactor, restructure, reorganize, cleanup |
| test | test, spec, coverage |
| chore | chore, build, ci, deps, bump, update dep |

### Examples

```bash
# Default interactive commit
/zerg:git --action commit --push

# Engine-driven auto commit
/zerg:git --action commit --mode auto --push

# Suggest only (no commit)
/zerg:git --action commit --mode suggest
```

---

## Action: branch

Create and list branches.

### Examples

```bash
# List all branches
/zerg:git --action branch

# Create a new branch from main
/zerg:git --action branch --name feature/auth --base main
```

---

## Action: merge

Merge with configurable strategy and conflict detection.

### Strategies

| Strategy | Behavior |
|----------|----------|
| squash | Squash all commits into one (default) |
| rebase | Rebase current branch onto target |
| merge | Standard merge commit |

### Examples

```bash
# Squash merge feature branch
/zerg:git --action merge --branch feature/auth --strategy squash

# Rebase onto feature
/zerg:git --action merge --branch feature/auth --strategy rebase
```

---

## Action: sync

Fetch from remote, pull with rebase, and optionally rebase onto base branch.

### Examples

```bash
# Sync current branch with main
/zerg:git --action sync --base main
```

---

## Action: history

View recent commit history or run cleanup via HistoryEngine.

### Examples

```bash
# Show last 20 commits
/zerg:git --action history

# Show commits since a tag
/zerg:git --action history --since v1.0.0

# Run history cleanup (HistoryEngine)
/zerg:git --action history --cleanup --base main
```

---

## Action: finish

Interactive workflow to complete a feature branch. Presents four options:

1. **merge** -- Squash merge into base, optionally push and delete branch
2. **pr** -- Push branch and prompt for manual PR creation
3. **keep** -- Push branch only
4. **discard** -- Delete branch and discard changes

### Examples

```bash
# Finish current branch into main
/zerg:git --action finish --base main

# Finish with auto-push
/zerg:git --action finish --base main --push
```

---

## Action: pr

Create a pull request with full context assembly via PREngine.

The engine:
1. Assembles context from commits, issues, and project files
2. Generates structured PR title, body, labels, and reviewers
3. Creates PR via `gh` CLI

### PR Body Template

```markdown
## Summary
<auto-generated from commits and context>

## Changes
- <bullet points from commit analysis>

## Test Plan
- <extracted from commit messages and changed files>
```

### Examples

```bash
# Create PR against main
/zerg:git --action pr --base main

# Create draft PR with reviewer
/zerg:git --action pr --draft --reviewer octocat

# PR against develop branch
/zerg:git --action pr --base develop
```

---

## Action: release

Automated semver release workflow via ReleaseEngine.

### Workflow Steps

1. Get latest version from tags
2. Analyze commits since last tag
3. Calculate version bump (or use override)
4. Generate changelog entry
5. Update version files
6. Commit, tag, and push
7. Create GitHub release

### Bump Types

| Type | When |
|------|------|
| auto | Calculated from conventional commits (default) |
| major | Breaking changes (BREAKING CHANGE in commits) |
| minor | New features (feat: commits) |
| patch | Bug fixes (fix: commits) |

### Examples

```bash
# Auto-detect bump from commits
/zerg:git --action release

# Force minor bump
/zerg:git --action release --bump minor

# Dry run to preview
/zerg:git --action release --dry-run

# Force patch release
/zerg:git --action release --bump patch
```

---

## Action: review

Pre-review context assembly via PreReviewEngine. Generates a structured review context document for the current branch.

### Focus Domains

| Domain | What It Highlights |
|--------|-------------------|
| security | Auth, input validation, secrets, injection vectors |
| performance | Algorithmic complexity, I/O patterns, caching |
| quality | Test coverage, error handling, code organization |
| architecture | Coupling, cohesion, dependency patterns, SOLID |

### Examples

```bash
# General review context
/zerg:git --action review --base main

# Security-focused review
/zerg:git --action review --focus security

# Architecture review
/zerg:git --action review --focus architecture --base develop
```

---

## Action: rescue

Recovery operations via RescueEngine. Provides undo, snapshot restore, and branch recovery.

### Sub-commands

| Flag | Operation |
|------|-----------|
| --list-ops | List recent git operations with timestamps |
| --undo | Undo the last recorded operation |
| --restore TAG | Restore repository state from a snapshot tag |
| --recover-branch NAME | Recover a deleted branch from reflog |

### Examples

```bash
# List recent operations
/zerg:git --action rescue --list-ops

# Undo last operation
/zerg:git --action rescue --undo

# Restore from snapshot
/zerg:git --action rescue --restore zerg-snapshot-20260201

# Recover deleted branch
/zerg:git --action rescue --recover-branch feature/auth
```

---

## Action: bisect

AI-powered binary search for bug-introducing commits via BisectEngine.

### Workflow

1. Specify symptom description and optional test command
2. Engine identifies good/bad commit range
3. Binary search narrows down the offending commit
4. Reports the commit that introduced the bug

### Examples

```bash
# Bisect with symptom and test command
/zerg:git --action bisect --symptom "login returns 500" --test-cmd "pytest tests/auth/"

# Bisect with known good commit
/zerg:git --action bisect --symptom "CSS broken" --good v1.2.0

# Bisect with all options
/zerg:git --action bisect --symptom "memory leak" --test-cmd "python bench.py" --good abc123 --base main
```

---

## Error Handling

All actions follow a consistent error pattern:

- **GitError**: Caught and reported with context
- **MergeConflictError**: Reports conflicting files and exits with code 1
- **KeyboardInterrupt**: Exits with code 130
- **General exceptions**: Logged and reported

## Help

When `--help` is passed, display usage and exit:

```
/zerg:git -- Git operations with intelligent commits, PR creation, releases, and more.

Flags:
  --action, -a ACTION   commit|branch|merge|sync|history|finish|pr|release|review|rescue|bisect
  --push, -p            Push after operation
  --base, -b BRANCH     Base branch (default: main)
  --name, -n NAME       Branch name (for branch action)
  --branch BRANCH       Branch to merge (for merge action)
  --strategy STRATEGY   merge|squash|rebase (default: squash)
  --since TAG           Starting point (for history action)
  --mode MODE           auto|confirm|suggest (commit mode)
  --cleanup             Run history cleanup
  --draft               Create draft PR
  --reviewer USER       PR reviewer username
  --focus DOMAIN        security|performance|quality|architecture
  --bump TYPE           auto|major|minor|patch (default: auto)
  --dry-run             Preview release without executing
  --symptom TEXT        Bug symptom (for bisect)
  --test-cmd CMD        Test command (for bisect)
  --good REF            Known good ref (for bisect)
  --list-ops            List rescue operations
  --undo                Undo last operation (rescue)
  --restore TAG         Restore snapshot (rescue)
  --recover-branch NAME Recover branch (rescue)
  --help                Show this help message
```
